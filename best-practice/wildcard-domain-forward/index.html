<!DOCTYPE html>
<html lang="zh" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.65.3" />
    <meta name="description" content="Kubernetes 实践指南">
<meta name="author" content="roc">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>泛域名转发</title>

    
    <link rel="stylesheet"
      href='https://kubetencent-1251707795.cos.accelerate.myqcloud.com/css/bundle.min.10bb02828e29fa3315241572ef5cf8181c079c0c86cfde9a587215c3f80fcf4e.css'>
    

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/best-practice/wildcard-domain-forward/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://k8s.imroc.io/" style="display:block">
  <div style="width:100%; height:100%;" >
    <img src="https://res.cloudinary.com/imroc/image/upload/c_scale,w_64/v1583293443/kubernetes-practice-guide/img/kubernetes.png" />
    <div style="height:100%; margin-bottom:3px; font-weight: bold;">Kubernetes 实践指南</div>
  </div>
</a>
    </div>
    
        
<div class="aa-input-container" id="aa-input-container">
    <input type="search" id="aa-search-input" class="aa-input-search" placeholder="搜索..."
        name="search" autocomplete="off" />
    <svg class="aa-input-icon" viewBox="654 -372 1664 1664">
        <path
            d="M1806,332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2,1481.3-116,1358-116s-228.8,43.8-316.5,131.5  C953.8,103.2,910,208.7,910,332s43.8,228.8,131.5,316.5C1129.2,736.2,1234.7,780,1358,780s228.8-43.8,316.5-131.5  C1762.2,560.8,1806,455.3,1806,332z M2318,1164c0,34.7-12.7,64.7-38,90s-55.3,38-90,38c-36,0-66-12.7-90-38l-343-342  c-119.3,82.7-252.3,124-399,124c-95.3,0-186.5-18.5-273.5-55.5s-162-87-225-150s-113-138-150-225S654,427.3,654,332  s18.5-186.5,55.5-273.5s87-162,150-225s138-113,225-150S1262.7-372,1358-372s186.5,18.5,273.5,55.5s162,87,225,150s113,138,150,225  S2062,236.7,2062,332c0,146.7-41.3,279.7-124,399l343,343C2305.7,1098.7,2318,1128.7,2318,1164z" />
    </svg>
</div>

<script type="text/javascript">
    
        var baseurl = "https:\/\/k8s.imroc.io\/";
    
</script>


    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
  
 

          
          




 
  
    
  
 

          
          




 
  
    
    <li data-nav-id="/deploy/" title="集群部署" class="dd-item 
        
        
        
        ">
      <a href="/deploy/">
          集群部署
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/deploy/selection/" title="方案选型" class="dd-item ">
        <a href="/deploy/selection/">
        方案选型
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deploy/kubespray/" title="使用 kubespray 部署" class="dd-item ">
        <a href="/deploy/kubespray/">
        使用 kubespray 部署
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/deploy/manual/" title="手工部署" class="dd-item 
        
        
        
        ">
      <a href="/deploy/manual/">
          手工部署
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/deploy/manual/prepare/" title="部署前的准备工作" class="dd-item ">
        <a href="/deploy/manual/prepare/">
        部署前的准备工作
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deploy/manual/bootstrapping-etcd/" title="部署 ETCD" class="dd-item ">
        <a href="/deploy/manual/bootstrapping-etcd/">
        部署 ETCD
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deploy/manual/bootstrapping-master/" title="部署 Master" class="dd-item ">
        <a href="/deploy/manual/bootstrapping-master/">
        部署 Master
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deploy/manual/bootstrapping-worker-nodes/" title="部署 Worker 节点" class="dd-item ">
        <a href="/deploy/manual/bootstrapping-worker-nodes/">
        部署 Worker 节点
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deploy/manual/deploy-critical-addons/" title="部署关键组件" class="dd-item ">
        <a href="/deploy/manual/deploy-critical-addons/">
        部署关键组件
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/deploy/addons/" title="附加组件" class="dd-item 
        
        
        
        ">
      <a href="/deploy/addons/">
          附加组件
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/deploy/addons/kube-proxy/" title="以 Daemonset 方式部署 kube-proxy" class="dd-item ">
        <a href="/deploy/addons/kube-proxy/">
        以 Daemonset 方式部署 kube-proxy
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deploy/addons/coredns/" title="部署 CoreDNS" class="dd-item ">
        <a href="/deploy/addons/coredns/">
        部署 CoreDNS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/deploy/appendix/" title="附录" class="dd-item 
        
        
        
        ">
      <a href="/deploy/appendix/">
          附录
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/deploy/appendix/install-kubectl/" title="安装 kubectl" class="dd-item ">
        <a href="/deploy/appendix/install-kubectl/">
        安装 kubectl
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/troubleshooting/" title="排错指南" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/">
          排错指南
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/troubleshooting/trick/" title="排错技巧" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/trick/">
          排错技巧
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/trick/use-systemtap-to-locate-problems/" title="使用 Systemtap 定位疑难杂症" class="dd-item ">
        <a href="/troubleshooting/trick/use-systemtap-to-locate-problems/">
        使用 Systemtap 定位疑难杂症
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/trick/analysis-exitcode/" title="分析 ExitCode 定位 Pod 异常退出原因" class="dd-item ">
        <a href="/troubleshooting/trick/analysis-exitcode/">
        分析 ExitCode 定位 Pod 异常退出原因
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/trick/capture-packets-in-container/" title="容器内抓包定位网络问题" class="dd-item ">
        <a href="/troubleshooting/trick/capture-packets-in-container/">
        容器内抓包定位网络问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/troubleshooting/handle/" title="处理实践" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/handle/">
          处理实践
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/handle/arp_cache-overflow/" title="arp_cache 溢出" class="dd-item ">
        <a href="/troubleshooting/handle/arp_cache-overflow/">
        arp_cache 溢出
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/handle/runnig-out-of-inotify-watches/" title="inotify watch 耗尽" class="dd-item ">
        <a href="/troubleshooting/handle/runnig-out-of-inotify-watches/">
        inotify watch 耗尽
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/handle/pid-full/" title="PID 耗尽" class="dd-item ">
        <a href="/troubleshooting/handle/pid-full/">
        PID 耗尽
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/handle/memory-fragmentation/" title="内存碎片化" class="dd-item ">
        <a href="/troubleshooting/handle/memory-fragmentation/">
        内存碎片化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/handle/disk-full/" title="磁盘爆满" class="dd-item ">
        <a href="/troubleshooting/handle/disk-full/">
        磁盘爆满
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/handle/high-load/" title="高负载" class="dd-item ">
        <a href="/troubleshooting/handle/high-load/">
        高负载
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/troubleshooting/node/" title="节点排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/node/">
          节点排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/node/arp_cache-neighbor-table-overflow/" title="arp_cache: neighbor table overflow! (arp缓存溢出)" class="dd-item ">
        <a href="/troubleshooting/node/arp_cache-neighbor-table-overflow/">
        arp_cache: neighbor table overflow! (arp缓存溢出)
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/node/cannot-allocate-memory/" title="Cannot allocate memory" class="dd-item ">
        <a href="/troubleshooting/node/cannot-allocate-memory/">
        Cannot allocate memory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/node/no-space-left-on-device/" title="no space left on device" class="dd-item ">
        <a href="/troubleshooting/node/no-space-left-on-device/">
        no space left on device
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/node/not-ready/" title="Node NotReady" class="dd-item ">
        <a href="/troubleshooting/node/not-ready/">
        Node NotReady
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/node/kernel-solft-lockup/" title="soft lockup (内核软死锁)" class="dd-item ">
        <a href="/troubleshooting/node/kernel-solft-lockup/">
        soft lockup (内核软死锁)
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/troubleshooting/pod/" title="Pod 排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/pod/">
          Pod 排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/slow-terminating/" title="Pod Terminating 慢" class="dd-item ">
        <a href="/troubleshooting/pod/slow-terminating/">
        Pod Terminating 慢
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-containercreating-or-waiting/" title="Pod 一直处于 ContainerCreating 或 Waiting 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-containercreating-or-waiting/">
        Pod 一直处于 ContainerCreating 或 Waiting 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-error/" title="Pod 一直处于 Error 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-error/">
        Pod 一直处于 Error 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-imageinspecterror/" title="Pod 一直处于 ImageInspectError 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-imageinspecterror/">
        Pod 一直处于 ImageInspectError 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-imagepullbackoff/" title="Pod 一直处于 ImagePullBackOff 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-imagepullbackoff/">
        Pod 一直处于 ImagePullBackOff 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-pending/" title="Pod 一直处于 Pending 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-pending/">
        Pod 一直处于 Pending 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-terminating/" title="Pod 一直处于 Terminating 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-terminating/">
        Pod 一直处于 Terminating 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-unkown/" title="Pod 一直处于 Unknown 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-unkown/">
        Pod 一直处于 Unknown 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/healthcheck-failed/" title="Pod 健康检查失败" class="dd-item ">
        <a href="/troubleshooting/pod/healthcheck-failed/">
        Pod 健康检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/keep-crashloopbackoff/" title="Pod 处于 CrashLoopBackOff 状态" class="dd-item ">
        <a href="/troubleshooting/pod/keep-crashloopbackoff/">
        Pod 处于 CrashLoopBackOff 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pod/container-proccess-exit-by-itself/" title="容器进程主动退出" class="dd-item ">
        <a href="/troubleshooting/pod/container-proccess-exit-by-itself/">
        容器进程主动退出
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/troubleshooting/network/" title="网络排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/network/">
          网络排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/network/dns/" title="DNS 解析异常" class="dd-item ">
        <a href="/troubleshooting/network/dns/">
        DNS 解析异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/network/lb-healthcheck-failed/" title="LB 健康检查失败" class="dd-item ">
        <a href="/troubleshooting/network/lb-healthcheck-failed/">
        LB 健康检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/network/service-unrecheable/" title="Service 不通" class="dd-item ">
        <a href="/troubleshooting/network/service-unrecheable/">
        Service 不通
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/network/service-cannot-resolve/" title="Service 无法解析" class="dd-item ">
        <a href="/troubleshooting/network/service-cannot-resolve/">
        Service 无法解析
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/network/low-throughput/" title="网络性能差" class="dd-item ">
        <a href="/troubleshooting/network/low-throughput/">
        网络性能差
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/troubleshooting/others/" title="其它排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/others/">
          其它排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/others/slow-apiserver/" title="APIServer 响应慢" class="dd-item ">
        <a href="/troubleshooting/others/slow-apiserver/">
        APIServer 响应慢
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/others/daemonset-not-scheduled/" title="Daemonset 没有被调度" class="dd-item ">
        <a href="/troubleshooting/others/daemonset-not-scheduled/">
        Daemonset 没有被调度
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/others/job-cannot-delete/" title="Job 无法被删除" class="dd-item ">
        <a href="/troubleshooting/others/job-cannot-delete/">
        Job 无法被删除
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/others/kubectl-exec-or-logs-failed/" title="kubectl 执行 exec 或 logs 失败" class="dd-item ">
        <a href="/troubleshooting/others/kubectl-exec-or-logs-failed/">
        kubectl 执行 exec 或 logs 失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/others/node-all-gone/" title="Node 全部消失" class="dd-item ">
        <a href="/troubleshooting/others/node-all-gone/">
        Node 全部消失
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/avoid/" title="避坑指南" class="dd-item 
        
        
        
        ">
      <a href="/avoid/">
          避坑指南
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/avoid/cgroup-leaking/" title="cgroup 泄露" class="dd-item ">
        <a href="/avoid/cgroup-leaking/">
        cgroup 泄露
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/conntrack-conflict/" title="conntrack 冲突导致丢包" class="dd-item ">
        <a href="/avoid/conntrack-conflict/">
        conntrack 冲突导致丢包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/tcp_tw_recycle-causes-packet-loss/" title="tcp tw recycle 引发丢包" class="dd-item ">
        <a href="/avoid/tcp_tw_recycle-causes-packet-loss/">
        tcp tw recycle 引发丢包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/nodelocal-dns/" title="使用 NodeLocal DNS (缓存)" class="dd-item ">
        <a href="/avoid/nodelocal-dns/">
        使用 NodeLocal DNS (缓存)
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/handle-cgroup-oom-in-userspace-with-oom-guard/" title="使用 oom-guard 在用户态处理 cgroup OOM" class="dd-item ">
        <a href="/avoid/handle-cgroup-oom-in-userspace-with-oom-guard/">
        使用 oom-guard 在用户态处理 cgroup OOM
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/scale-keepalive-service/" title="解决长连接服务扩容失效" class="dd-item ">
        <a href="/avoid/scale-keepalive-service/">
        解决长连接服务扩容失效
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/avoid/cases/" title="踩坑分享" class="dd-item 
        
        
        
        ">
      <a href="/avoid/cases/">
          踩坑分享
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/arp-cache-overflow-causes-healthcheck-failed/" title="ARP 缓存爆满导致健康检查失败" class="dd-item ">
        <a href="/avoid/cases/arp-cache-overflow-causes-healthcheck-failed/">
        ARP 缓存爆满导致健康检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/dns-lookup-5s-delay/" title="DNS 5 秒延时" class="dd-item ">
        <a href="/avoid/cases/dns-lookup-5s-delay/">
        DNS 5 秒延时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/dns-resolution-abnormal/" title="DNS 解析异常" class="dd-item ">
        <a href="/avoid/cases/dns-resolution-abnormal/">
        DNS 解析异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/schemaerror-when-using-kubectl-apply-or-edit/" title="kubectl edit 或者 apply 报 SchemaError" class="dd-item ">
        <a href="/avoid/cases/schemaerror-when-using-kubectl-apply-or-edit/">
        kubectl edit 或者 apply 报 SchemaError
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/low-cps-from-lb-to-nodeport/" title="LB 压测 NodePort CPS 低" class="dd-item ">
        <a href="/avoid/cases/low-cps-from-lb-to-nodeport/">
        LB 压测 NodePort CPS 低
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/livenesprobe-failed-occasionally/" title="Pod 偶尔存活检查失败" class="dd-item ">
        <a href="/avoid/cases/livenesprobe-failed-occasionally/">
        Pod 偶尔存活检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/high-legacy-from-pod-to-another-apiserver/" title="Pod 访问另一个集群的 apiserver 有延时" class="dd-item ">
        <a href="/avoid/cases/high-legacy-from-pod-to-another-apiserver/">
        Pod 访问另一个集群的 apiserver 有延时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/kubernetes-overflow-and-drop/" title="神秘的溢出与丢包" class="dd-item ">
        <a href="/avoid/cases/kubernetes-overflow-and-drop/">
        神秘的溢出与丢包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/lb-with-local-externaltrafficpolicy-timeout-occasionally/" title="访问 externalTrafficPolicy 为 Local 的 Service 对应 LB 有时超时" class="dd-item ">
        <a href="/avoid/cases/lb-with-local-externaltrafficpolicy-timeout-occasionally/">
        访问 externalTrafficPolicy 为 Local 的 Service 对应 LB 有时超时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/no-route-to-host/" title="诡异的 No route to host" class="dd-item ">
        <a href="/avoid/cases/no-route-to-host/">
        诡异的 No route to host
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/cross-vpc-connect-nodeport-timeout/" title="跨 VPC 访问 NodePort 经常超时" class="dd-item ">
        <a href="/avoid/cases/cross-vpc-connect-nodeport-timeout/">
        跨 VPC 访问 NodePort 经常超时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/avoid/cases/eviction-leads-to-service-disruption/" title="驱逐导致服务中断" class="dd-item ">
        <a href="/avoid/cases/eviction-leads-to-service-disruption/">
        驱逐导致服务中断
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/optimization/" title="集群优化" class="dd-item 
        
        
        
        ">
      <a href="/optimization/">
          集群优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/optimization/deploy/" title="应用部署优化" class="dd-item 
        
        
        
        ">
      <a href="/optimization/deploy/">
          应用部署优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/optimization/deploy/use-pdb-to-avoid-service-unavailable-during-eviction/" title="使用 PodDisruptionBudget 避免驱逐导致服务不可用" class="dd-item ">
        <a href="/optimization/deploy/use-pdb-to-avoid-service-unavailable-during-eviction/">
        使用 PodDisruptionBudget 避免驱逐导致服务不可用
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/optimization/deploy/smooth-update-using-prestophook-and-readinessprobe/" title="使用 preStopHook 和 readinessProbe 保证服务平滑更新不中断" class="dd-item ">
        <a href="/optimization/deploy/smooth-update-using-prestophook-and-readinessprobe/">
        使用 preStopHook 和 readinessProbe 保证服务平滑更新不中断
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/optimization/deploy/use-antiaffinity-to-avoid-single-points-of-failure/" title="使用反亲和性避免单点故障" class="dd-item ">
        <a href="/optimization/deploy/use-antiaffinity-to-avoid-single-points-of-failure/">
        使用反亲和性避免单点故障
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/optimization/etcd/" title="ETCD 优化" class="dd-item ">
        <a href="/optimization/etcd/">
        ETCD 优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/optimization/master/" title="Master 优化" class="dd-item ">
        <a href="/optimization/master/">
        Master 优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/optimization/kernel/" title="内核参数优化" class="dd-item ">
        <a href="/optimization/kernel/">
        内核参数优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/security/" title="集群安全" class="dd-item 
        
        
        
        ">
      <a href="/security/">
          集群安全
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/security/user/" title="用户管理" class="dd-item 
        
        
        
        ">
      <a href="/security/user/">
          用户管理
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/security/user/create-user-using-csr-api/" title="利用 CSR API 创建用户" class="dd-item ">
        <a href="/security/user/create-user-using-csr-api/">
        利用 CSR API 创建用户
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/security/permission/" title="集群权限控制" class="dd-item 
        
        
        
        ">
      <a href="/security/permission/">
          集群权限控制
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/security/permission/app/" title="控制应用权限" class="dd-item ">
        <a href="/security/permission/app/">
        控制应用权限
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/security/permission/user/" title="控制用户权限" class="dd-item ">
        <a href="/security/permission/user/">
        控制用户权限
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/security/cert/" title="集群证书管理" class="dd-item 
        
        
        
        ">
      <a href="/security/cert/">
          集群证书管理
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/security/cert/install-cert-manger/" title="安装 cert-manager" class="dd-item ">
        <a href="/security/cert/install-cert-manger/">
        安装 cert-manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/security/cert/autogenerate-certificate-with-cert-manager/" title="使用 cert-manager 自动生成证书" class="dd-item ">
        <a href="/security/cert/autogenerate-certificate-with-cert-manager/">
        使用 cert-manager 自动生成证书
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/trick/" title="实用技巧" class="dd-item 
        
        
        
        ">
      <a href="/trick/">
          实用技巧
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/trick/efficient-kubectl/" title="kubectl 高效技巧" class="dd-item ">
        <a href="/trick/efficient-kubectl/">
        kubectl 高效技巧
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/trick/yaml/" title="yaml 片段" class="dd-item 
        
        
        
        ">
      <a href="/trick/yaml/">
          yaml 片段
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/trick/yaml/deployment/" title="Deployment" class="dd-item ">
        <a href="/trick/yaml/deployment/">
        Deployment
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/trick/shell/" title="实用命令与脚本" class="dd-item 
        
        
        
        ">
      <a href="/trick/shell/">
          实用命令与脚本
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/trick/shell/pod/" title="Pod 相关脚本" class="dd-item ">
        <a href="/trick/shell/pod/">
        Pod 相关脚本
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/trick/shell/network/" title="网络调试相关脚本" class="dd-item ">
        <a href="/trick/shell/network/">
        网络调试相关脚本
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/trick/shell/node/" title="节点相关脚本" class="dd-item ">
        <a href="/trick/shell/node/">
        节点相关脚本
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/monitoring/" title="监控告警" class="dd-item 
        
        
        
        ">
      <a href="/monitoring/">
          监控告警
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/monitoring/wechat-work-alert/" title="企业微信告警" class="dd-item ">
        <a href="/monitoring/wechat-work-alert/">
        企业微信告警
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/monitoring/dingtalk-alert/" title="钉钉告警" class="dd-item ">
        <a href="/monitoring/dingtalk-alert/">
        钉钉告警
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/log/" title="日志搜集" class="dd-item 
        
        
        
        ">
      <a href="/log/">
          日志搜集
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/bigdata-ai/" title="大数据与 AI" class="dd-item 
        
        
        
        ">
      <a href="/bigdata-ai/">
          大数据与 AI
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/bigdata-ai/flink-on-kubernetes/" title="Flink on Kubernetes" class="dd-item 
        
        
        
        ">
      <a href="/bigdata-ai/flink-on-kubernetes/">
          Flink on Kubernetes
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/bigdata-ai/flink-on-kubernetes/intro/" title="Flink 介绍" class="dd-item ">
        <a href="/bigdata-ai/flink-on-kubernetes/intro/">
        Flink 介绍
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/bigdata-ai/flink-on-kubernetes/flink-on-kubernetes/" title="Flink on Kubernetes 方案" class="dd-item ">
        <a href="/bigdata-ai/flink-on-kubernetes/flink-on-kubernetes/">
        Flink on Kubernetes 方案
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/bigdata-ai/flink-on-kubernetes/session-cluster/" title="Session Cluster 模式部署" class="dd-item ">
        <a href="/bigdata-ai/flink-on-kubernetes/session-cluster/">
        Session Cluster 模式部署
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/bigdata-ai/flink-on-kubernetes/job-cluster/" title="Job Cluster 模式部署" class="dd-item ">
        <a href="/bigdata-ai/flink-on-kubernetes/job-cluster/">
        Job Cluster 模式部署
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/bigdata-ai/flink-on-kubernetes/native-kubernetes/" title="Native Kubernetes 模式部署" class="dd-item ">
        <a href="/bigdata-ai/flink-on-kubernetes/native-kubernetes/">
        Native Kubernetes 模式部署
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dev/" title="开发指南" class="dd-item 
        
        
        
        ">
      <a href="/dev/">
          开发指南
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/dev/golang-build/" title="Go 语言编译原理与优化" class="dd-item ">
        <a href="/dev/golang-build/">
        Go 语言编译原理与优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dev/client-go/" title="使用 client-go 开发 k8s 应用" class="dd-item ">
        <a href="/dev/client-go/">
        使用 client-go 开发 k8s 应用
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="zh" value="https://k8s.imroc.io/best-practice/wildcard-domain-forward/" selected>简体中文</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> 清理历史记录</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='编辑当前页' href="https://github.com/imroc/kubernetes-practice-guide/edit/master/content/zh/best-practice/wildcard-domain-forward.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">编辑当前页</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Kubernetes 实践指南</a> > <a href='/best-practice/'>最佳实践</a> > 泛域名转发
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#需求">需求</a></li>
    <li><a href="#简单做法">简单做法</a></li>
    <li><a href="#正确姿势">正确姿势</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              泛域名转发
            </h1>
          

        





<h2 id="需求">需求</h2>
<p>集群对外暴露了一个公网IP作为流量入口(可以是 Ingress 或 Service)，DNS 解析配置了一个泛域名指向该IP（比如 <code>*.test.imroc.io</code>），现希望根据请求中不同 Host 转发到不同的后端 Service。比如 <code>a.test.imroc.io</code> 的请求被转发到 <code>my-svc-a</code>，<code>b.test.imroc.io</code> 的请求转发到 <code>my-svc-b</code>。当前 K8S 的 Ingress 并不原生支持这种泛域名转发规则，本文将给出一个解决方案来实现泛域名转发。</p>
<h2 id="简单做法">简单做法</h2>
<p>先说一种简单的方法，这也是大多数人的第一反应：<strong>配置 Ingress 规则</strong></p>
<p>假如泛域名有两个不同 Host 分别转发到不同 Service，Ingress 类似这样写:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: extensions/v1beta1
<span style="color:#66d9ef">kind</span>: Ingress
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: my-ingress
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">rules</span>:
  - <span style="color:#66d9ef">host</span>: a.test.imroc.io
    <span style="color:#66d9ef">http</span>:
      <span style="color:#66d9ef">paths</span>:
      - <span style="color:#66d9ef">backend</span>:
          <span style="color:#66d9ef">serviceName</span>: my-svc-a
          <span style="color:#66d9ef">servicePort</span>: <span style="color:#ae81ff">80</span>
        <span style="color:#66d9ef">path</span>: /
  - <span style="color:#66d9ef">host</span>: b.test.imroc.io
    <span style="color:#66d9ef">http</span>:
      <span style="color:#66d9ef">paths</span>:
      - <span style="color:#66d9ef">backend</span>:
          <span style="color:#66d9ef">serviceName</span>: my-svc-b
          <span style="color:#66d9ef">servicePort</span>: <span style="color:#ae81ff">80</span>
        <span style="color:#66d9ef">path</span>: /
</code></pre></div><p>但是！如果 Host 非常多会怎样？（比如200+）</p>
<ul>
<li>每次新增 Host 都要改 Ingress 规则，太麻烦</li>
<li>单个 Ingress 上面的规则越来越多，更改规则对 LB 的压力变大，可能会导致偶尔访问不了</li>
</ul>
<h2 id="正确姿势">正确姿势</h2>
<p>我们可以约定请求中泛域名 Host 通配符的 <code>*</code> 号匹配到的字符跟 Service 的名字相关联（可以是相等，或者 Service 统一在前面加个前缀，比如 <code>a.test.imroc.io</code> 转发到 <code>my-svc-a</code> 这个 Service)，集群内起一个反向代理服务，匹配泛域名的请求全部转发到这个代理服务上，这个代理服务只做一件简单的事，解析 Host，正则匹配抓取泛域名中 <code>*</code> 号这部分，把它转换为 Service 名字，然后在集群里转发（集群 DNS 解析)</p>
<p>这个反向代理服务可以是 Nginx+Lua脚本 来实现，或者自己写个简单程序来做反向代理，这里我用 <a href="https://openresty.org">OpenResty</a> 来实现，它可以看成是 Nginx 的发行版，自带 lua 支持。</p>
<p>有几点需要说明下：</p>
<ul>
<li>我们使用 nginx 的  <code>proxy_pass</code> 来反向代理到后端服务，<code>proxy_pass</code> 后面跟的变量，我们需要用 lua 来判断 Host 修改变量</li>
<li>nginx 的 <code>proxy_pass</code> 后面跟的如果是可变的域名（非IP，需要 dns 解析)，它需要一个域名解析器，不会走默认的 dns 解析，需要在 <code>nginx.conf</code> 里添加 <code>resolver</code> 配置项来设置一个外部的 dns 解析器</li>
<li>这个解析器我们是用 go-dnsmasq 来实现，它可以将集群的 dns 解析代理给 nginx，以 sidecar 的形式注入到 pod 中，监听 53 端口</li>
</ul>
<p><code>nginx.conf</code> 里关键的配置如下图所示：</p>
<p><img src="https://imroc.io/assets/blog/nginx-wilcard-conf.png" alt="nginx.conf"></p>
<p>下面给出完整的 yaml 示例</p>
<p><code>proxy.yaml</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: apps/v1beta1
<span style="color:#66d9ef">kind</span>: Deployment
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">labels</span>:
    <span style="color:#66d9ef">component</span>: nginx
  <span style="color:#66d9ef">name</span>: proxy
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">replicas</span>: <span style="color:#ae81ff">1</span>
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">matchLabels</span>:
      <span style="color:#66d9ef">component</span>: nginx
  <span style="color:#66d9ef">template</span>:
    <span style="color:#66d9ef">metadata</span>:
      <span style="color:#66d9ef">labels</span>:
        <span style="color:#66d9ef">component</span>: nginx
    <span style="color:#66d9ef">spec</span>:
      <span style="color:#66d9ef">containers</span>:
      - <span style="color:#66d9ef">name</span>: nginx
        <span style="color:#66d9ef">image</span>: <span style="color:#e6db74">&#34;openresty/openresty:centos&#34;</span>
        <span style="color:#66d9ef">ports</span>:
        - <span style="color:#66d9ef">name</span>: http
          <span style="color:#66d9ef">containerPort</span>: <span style="color:#ae81ff">80</span>
          <span style="color:#66d9ef">protocol</span>: TCP
        <span style="color:#66d9ef">volumeMounts</span>:
        - <span style="color:#66d9ef">mountPath</span>: /usr/local/openresty/nginx/conf/nginx.conf
          <span style="color:#66d9ef">name</span>: config
          <span style="color:#66d9ef">subPath</span>: nginx.conf
      - <span style="color:#66d9ef">name</span>: dnsmasq
        <span style="color:#66d9ef">image</span>: <span style="color:#e6db74">&#34;janeczku/go-dnsmasq:release-1.0.7&#34;</span>
        <span style="color:#66d9ef">args</span>:
          - --listen
          - <span style="color:#e6db74">&#34;127.0.0.1:53&#34;</span>
          - --default-resolver
          - --append-search-domains
          - --hostsfile=/etc/hosts
          - --verbose
      <span style="color:#66d9ef">volumes</span>:
      - <span style="color:#66d9ef">name</span>: config
        <span style="color:#66d9ef">configMap</span>:
          <span style="color:#66d9ef">name</span>: configmap-nginx

---

<span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: ConfigMap
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">labels</span>:
    <span style="color:#66d9ef">component</span>: nginx
  <span style="color:#66d9ef">name</span>: configmap-nginx
<span style="color:#66d9ef">data</span>:
  <span style="color:#66d9ef">nginx.conf</span>: |<span style="color:#e6db74">-
</span><span style="color:#e6db74">    worker_processes  1;</span>

    error_log  /error.log;

    events {
        accept_mutex on;
        multi_accept on;
        use epoll;
        worker_connections  <span style="color:#ae81ff">1024</span>;
    }


    http {
        include       mime.types;
        default_type  application/octet-stream;
        log_format  main  <span style="color:#e6db74">&#39;$time_local $remote_user $remote_addr $host $request_uri $request_method $http_cookie &#39;</span>
                          <span style="color:#e6db74">&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
                          <span style="color:#e6db74">&#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34; &#39;</span>
                          <span style="color:#e6db74">&#39;$request_time $upstream_response_time &#34;$upstream_cache_status&#34;&#39;</span>;

        log_format  browser <span style="color:#e6db74">&#39;$time_iso8601 $cookie_km_uid $remote_addr $host $request_uri $request_method &#39;</span>
                          <span style="color:#e6db74">&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
                          <span style="color:#e6db74">&#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34; &#39;</span>
                          <span style="color:#e6db74">&#39;$request_time $upstream_response_time &#34;$upstream_cache_status&#34; $http_x_requested_with $http_x_real_ip $upstream_addr $request_body&#39;</span>;

        log_format client <span style="color:#e6db74">&#39;{&#34;@timestamp&#34;:&#34;$time_iso8601&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;time_local&#34;:&#34;$time_local&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;remote_user&#34;:&#34;$remote_user&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;http_x_forwarded_for&#34;:&#34;$http_x_forwarded_for&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;host&#34;:&#34;$server_addr&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;remote_addr&#34;:&#34;$remote_addr&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;http_x_real_ip&#34;:&#34;$http_x_real_ip&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;body_bytes_sent&#34;:$body_bytes_sent,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;request_time&#34;:$request_time,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;status&#34;:$status,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;upstream_response_time&#34;:&#34;$upstream_response_time&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;upstream_response_status&#34;:&#34;$upstream_status&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;request&#34;:&#34;$request&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;http_referer&#34;:&#34;$http_referer&#34;,&#39;</span>
                          <span style="color:#e6db74">&#39;&#34;http_user_agent&#34;:&#34;$http_user_agent&#34;}&#39;</span>;

        access_log  /access.log  main;

        sendfile        on;

        keepalive_timeout 120s 100s;
        keepalive_requests <span style="color:#ae81ff">500</span>;
        send_timeout 60000s;
        client_header_buffer_size 4k;
        proxy_ignore_client_abort on;
        proxy_buffers <span style="color:#ae81ff">16</span> 32k;
        proxy_buffer_size 64k;

        proxy_busy_buffers_size 64k;

        proxy_send_timeout <span style="color:#ae81ff">60000</span>;
        proxy_read_timeout <span style="color:#ae81ff">60000</span>;
        proxy_connect_timeout <span style="color:#ae81ff">60000</span>;
        proxy_cache_valid <span style="color:#ae81ff">200</span> <span style="color:#ae81ff">304</span> 2h;
        proxy_cache_valid <span style="color:#ae81ff">500</span> <span style="color:#ae81ff">404</span> 2s;
        proxy_cache_key $host$request_uri$cookie_user;
        proxy_cache_methods GET HEAD POST;

        proxy_redirect off;
        proxy_http_version <span style="color:#ae81ff">1.1</span>;
        proxy_set_header Host                $http_host;
        proxy_set_header X-Real-IP           $remote_addr;
        proxy_set_header X-Forwarded-For     $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto   $scheme;
        proxy_set_header X-Frame-Options     SAMEORIGIN;

        server_tokens off;
        client_max_body_size 50G;
        add_header X-Cache $upstream_cache_status;
        autoindex off;

        resolver      <span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">53</span> ipv6=off;

        server {
            listen <span style="color:#ae81ff">80</span>;

            location / {
                set $service  <span style="color:#e6db74">&#39;&#39;</span>;
                rewrite_by_lua <span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">                    local host = ngx.var.host
</span><span style="color:#e6db74">                    local m = ngx.re.match(host, &#34;(.+).test.imroc.io&#34;)
</span><span style="color:#e6db74">                    if m then
</span><span style="color:#e6db74">                        ngx.var.service = &#34;my-svc-&#34; .. m[1]
</span><span style="color:#e6db74">                    end
</span><span style="color:#e6db74">                &#39;</span>;
                proxy_pass http://$service;
            }
        }
    }
</code></pre></div><p>让该代理服务暴露公网访问可以用 Service 或 Ingress</p>
<p>用 Service 的示例 (<code>service.yaml</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Service
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">labels</span>:
    <span style="color:#66d9ef">component</span>: nginx
  <span style="color:#66d9ef">name</span>: service-nginx
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">type</span>: LoadBalancer
  <span style="color:#66d9ef">ports</span>:
  - <span style="color:#66d9ef">name</span>: http
    <span style="color:#66d9ef">port</span>: <span style="color:#ae81ff">80</span>
    <span style="color:#66d9ef">targetPort</span>: http
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">component</span>: nginx
</code></pre></div><p>用 Ingress 的示例 (<code>ingress.yaml</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: extensions/v1beta1
<span style="color:#66d9ef">kind</span>: Ingress
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: ingress-nginx
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">rules</span>:
  - <span style="color:#66d9ef">host</span>: <span style="color:#e6db74">&#34;*.test.imroc.io&#34;</span>
    <span style="color:#66d9ef">http</span>:
      <span style="color:#66d9ef">paths</span>:
      - <span style="color:#66d9ef">backend</span>:
          <span style="color:#66d9ef">serviceName</span>: service-nginx
          <span style="color:#66d9ef">servicePort</span>: <span style="color:#ae81ff">80</span>
        <span style="color:#66d9ef">path</span>: /
</code></pre></div>

<footer class="footline">
	
</footer>

        
        </div> 
       
         <div class="entry-shang text-center">
    <p>「真诚赞赏，手留余香」</p>
    <button class="zs show-zs btn btn-bred">赞赏</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
    <div class="zs-modal-head">
        <button type="button" class="close">×</button>
        <span class="author"><img
                src="https://res.cloudinary.com/imroc/image/upload/c_scale,w_128/v1583303821/img/favicon.jpg" />roc</span>
        <p class="tip"><i></i><span>请我喝杯咖啡？</span></p>
    </div>
    <div class="zs-modal-body">
        <div class="zs-modal-btns">
            <button class="btn btn-blink" data-num="2">2元</button>
            <button class="btn btn-blink" data-num="5">5元</button>
            <button class="btn btn-blink" data-num="10">10元</button>
            <button class="btn btn-blink" data-num="50">50元</button>
            <button class="btn btn-blink" data-num="100">100元</button>
            <button class="btn btn-blink" data-num="1">任意金额</button>
        </div>
        <div class="zs-modal-pay">
            <button class="btn btn-bred" id="pay-text">2元</button>
            <p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
            <img src="/img/wechat-2.png" id="pay-image"/>
        </div>
    </div>
    <div class="zs-modal-footer">
        <label>
            <input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked">
            <span class="zs-wechat"><img src="/img/wechat-btn.png" /></span>
        </label>
        <label>
            <input type="radio" name="zs-type" value="alipay" class="zs-type">
            <span class="zs-alipay"><img src="/img/alipay-btn.png" /></span>
        </label>
    </div>
</div>
       
        
          <div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
  
  console.log("gitalk id:90a481b8629d190c2930a4dd500a45e7")
  var gitalk = new Gitalk({
      clientID: '6e0166abfd4b13fb3f6e',
      clientSecret: '9960a67408e0cc826566869e0e3247017004d007',
      repo: 'kubernetes-practice-guide',
      owner: 'imroc',
      admin: ["imroc"],
      labels: ['Gitalk'],
      title: '泛域名转发',
      createIssueManually: false,
      id: '90a481b8629d190c2930a4dd500a45e7',
      distractionFreeMode: true
  });
  gitalk.render('gitalk-container');
</script>
        
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
        
                    
                        
            
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
		
			<a class="nav nav-next" href="/deploy/" title="集群部署" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>

    <script>
      window.algoliaAppID='B6Q6PSGUV5';
      window.algoliaKey='5b4678e9995fe4211c4fa43ad2ffdab5';
      window.algoliaIndex='kubernetes-practice-guide-zh';
    </script>
    
    <script src='https://kubetencent-1251707795.cos.accelerate.myqcloud.com/js/bundle.min.d2d3888b947d0dd3dbc4cf91680c3654991c1a1ca525f0696b0061acfc692f7e.js'></script>
    
    

  </body>
</html>

